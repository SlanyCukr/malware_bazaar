import logging

from classes.database_client import DatabaseClient
from classes.graphml_processor import GraphMLProcessor
from utils.utils import get_db_credentials

handler = logging.StreamHandler()
handler.setLevel(logging.DEBUG)
formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
handler.setFormatter(formatter)
LOG = logging.getLogger(__name__)
LOG.setLevel(logging.DEBUG)
LOG.addHandler(handler)

if __name__ == "__main__":
    database_client = DatabaseClient(**get_db_credentials())

    processed_tags = ["tesla", "trojan", "stealc", "formbook", "heodo"]
    #processed_tags = ["stealc"]

    graphml_processor = GraphMLProcessor(database_client, processed_tags, LOG)

    graphml_processor.load_malware_graphml_paths_for_tags()
    graphml_processor.process_graphml_files()
    graphml_processor.visualize_graphml_files("/home/cape/malware_bazaar/visualization/svg")
    test = ""